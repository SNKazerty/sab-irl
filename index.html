<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Steal a Brainrot IRL</title>
<style>
  body { font-family: system-ui, Arial; background: #0b0b0b; color: #f4f4f4; margin:0; padding:18px }
  .wrap { max-width:920px; margin:0 auto }
  header { display:flex; align-items:center; gap:12px; margin-bottom:12px }
  h1 { font-size:20px; margin:0 }
  .card { background:linear-gradient(180deg,#111,#0b0b0b); border-radius:12px; padding:12px; margin:10px 0; border:1px solid rgba(255,255,255,0.04) }
  .row { display:flex; justify-content:space-between; align-items:center }
  .big { font-size:1.1rem; font-weight:800 }
  .small { font-size:0.85rem; color:#bdbdbd }
  .imgbox { width:120px; height:120px; border-radius:10px; background:#151515; display:flex; align-items:center; justify-content:center; overflow:hidden }
  button { padding:8px 12px; border-radius:8px; border:0; background:#ff6b6b; color:white; cursor:pointer; font-weight:700 }
  #catalogModal { max-height:70vh; overflow-y:auto }
</style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>Steal a Brainrot IRL</h1>
    <div class="small">Scan, ajoute, collectionne.</div>
  </header>

  <div class="card" id="scanInfo"></div>

  <div class="card">
    <div class="row">
      <div>
        <div class="small">Ton inventaire (stock√© localement)</div>
        <div id="totalPerSec" class="big">Total: 0 /s</div>
      </div>
      <div><button id="openCatalog">Voir le catalogue</button></div>
    </div>
    <div id="collection" style="margin-top:10px"></div>
  </div>

  <div id="catalogModal" style="display:none" class="card"></div>
</div>

<script type="module">
  import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

  const supabaseUrl = "https://ioxpakhblgldnopselvj.supabase.co";
  const supabaseKey = "eyJh..." // ta cl√© anon publique (pas la service_role)
  const supabase = createClient(supabaseUrl, supabaseKey);

  const params = new URLSearchParams(window.location.search);
  const id = params.get("id");

  async function loadBrainrot() {
    if (!id) {
      document.querySelector("#app").innerHTML = "<p>Aucun id fourni üßê</p>";
      return;
    }

    const { data, error } = await supabase
      .from("Brainrots")
      .select("*")
      .eq("id", id)
      .single();

    if (error) {
      console.error(error);
      document.querySelector("#app").innerHTML = "<p>Erreur en r√©cup√©rant le brainrot üò¢</p>";
      return;
    }

    if (!data) {
      document.querySelector("#app").innerHTML = "<p>Brainrot introuvable üò¨</p>";
      return;
    }

    document.querySelector("#app").innerHTML = `
      <h1>${data.name}</h1>
      <p>${data.desc || "Pas de description üò∂"}</p>
    `;
  }

  loadBrainrot();
</script>
</body>
</html>
